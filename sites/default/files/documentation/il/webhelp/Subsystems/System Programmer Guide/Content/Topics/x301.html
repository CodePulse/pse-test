<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="System Programmer Guide.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="System Programmer Guide|Developing New Foreign Objects|The gPROMS Foreign Object Interface">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>The Foreign Object initialisation procedure</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../Resources/TableStyles/GeneralTable.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/GeneralStyles.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../System Programmer Guide.htm#Topics/x301.html">Open topic with navigation</a>
        </p>
        <div>
            <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="c251.html">System Programmer Guide</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="c271.html">Developing New Foreign Objects</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="x276.html">The gPROMS Foreign Object Interface</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">The Foreign Object initialisation procedure</span>
            </div>
        </div>
        <h1><a name="ForeignObjectInitialisationProcedure"></a>The Foreign Object initialisation procedure</h1>
        <p>At the start of executing a Process entity, gPROMS will construct a list of all distinct Foreign Object classes and their instances that are
 used by it. It then attempts to create each instance by calling the gFOI procedure of the corresponding class.</p>
        <p>The gFOI procedure has the following form:</p>
        <ul>
            <li value="1">
                <p>gFOI (ForeignObjectID, ForeignObjectHandle, Status)</p>
            </li>
        </ul>
        <p>where the arguments are as described in the table below.</p>
        <div class="table"><a name="AEN309"></a>
            <table style="mc-table-style: url('../Resources/TableStyles/GeneralTable.css');margin-left: auto;margin-right: auto;" class="TableStyle-GeneralTable" cellspacing="0">
                <caption>Arguments of the procedure gFOI.</caption>
                <thead>
                    <tr class="TableStyle-GeneralTable-Head-Header1">
                        <th align="center" class="TableStyle-GeneralTable-HeadE-Column1-Header1">Name of Argument</th>
                        <th align="center" class="TableStyle-GeneralTable-HeadE-Column1-Header1">Type</th>
                        <th align="center" class="TableStyle-GeneralTable-HeadE-Column1-Header1">Description</th>
                        <th align="center" class="TableStyle-GeneralTable-HeadE-Column1-Header1">Specified on Entry</th>
                        <th class="TableStyle-GeneralTable-HeadD-Column1-Header1">Specified on Exit</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-GeneralTable-Body-Body1">
                        <td class="TableStyle-GeneralTable-BodyE-Column1-Body1">ForeignObjectID</td>
                        <td class="TableStyle-GeneralTable-BodyE-Column1-Body1">Character*256</td>
                        <td class="TableStyle-GeneralTable-BodyE-Column1-Body1">Full name of Foreign Object (terminated with a null).</td>
                        <td class="TableStyle-GeneralTable-BodyE-Column1-Body1">YES</td>
                        <td class="TableStyle-GeneralTable-BodyD-Column1-Body1">NO</td>
                    </tr>
                    <tr class="TableStyle-GeneralTable-Body-Body2">
                        <td class="TableStyle-GeneralTable-BodyE-Column1-Body2">ForeignObjectHandle</td>
                        <td class="TableStyle-GeneralTable-BodyE-Column1-Body2">Integer</td>
                        <td class="TableStyle-GeneralTable-BodyE-Column1-Body2">Handle for identifying Foreign Object in subsequent calls (see text).</td>
                        <td class="TableStyle-GeneralTable-BodyE-Column1-Body2">NO</td>
                        <td class="TableStyle-GeneralTable-BodyD-Column1-Body2">YES</td>
                    </tr>
                    <tr class="TableStyle-GeneralTable-Body-Body1">
                        <td class="TableStyle-GeneralTable-BodyB-Column1-Body1">Status</td>
                        <td class="TableStyle-GeneralTable-BodyB-Column1-Body1">Integer</td>
                        <td class="TableStyle-GeneralTable-BodyB-Column1-Body1">Status of this initialisation. Status = 1 implies successful initialisation. All other values signify failure.</td>
                        <td class="TableStyle-GeneralTable-BodyB-Column1-Body1">NO</td>
                        <td class="TableStyle-GeneralTable-BodyA-Column1-Body1">YES</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p>The ForeignObjectID is a string identifying the instance of the Foreign Object class that is to be created. The class name is prepended to the
 instance name separated from it by a double colon "::''. For example, in the case of the example shown in the gPROMS code below, gPROMS would set
 ForeignObjectID to:</p><pre class="programlisting">"ThermoPack::MygPROMSDir/Aromatics.tpk"</pre>
        <p>in the call to gFOI.</p>
        <p>An example of a gPROMS Model using a Foreign Object:</p><pre class="programlisting">1 MODEL Flash

 2 PARAMETER
 3 PPP AS FOREIGN_OBJECT "ThermoPack"
 4 NoComp AS INTEGER

 5 VARIABLE
 6 F, L, V AS MolarRate
 7 Hf AS MolarEnergy
 8 Q AS EnergyRate
 9 T AS Temperature
10 P AS Pressure
11 x, y, z AS ARRAY(NoComp) OF MoleFraction

12 SET
13 NoComp := PPP.NumberOfComponents ;

14 EQUATION
15 F*z = L*x + V*y ;
16 F*Hf = L*PPP.LiquidEnthalpy(T,P,x) + V*PPP.VapourEnthalpy(T,P,y) + Q ;
17 x*PPP.LiquidFugacityCoeff(T,P,x) = y*PPP.VapourFugacityCoeff(T,P,y) ;
18 SIGMA(x) = SIGMA(y) = 1 ;
19 IF PPP.StableLiquid(T,P,x) THEN
20 ...
21 ELSE
22 ...
23 END
24 END # Model Flash</pre>
        <p>Setting of a Foreign Object value within a Process entity:</p><pre class="programlisting">1 PROCESS PlantSimulation

 2 UNIT
 3 Plant AS TwoTankSystem

 4 SET
 5 Plant.LPPP := "MygPROMSDir/LPThermo.tpk" ;

 6 ...</pre>
        <p>gPROMS is not concerned with the way in which the external software will actually interpret the ForeignObjectID passed to it. However, the
 success or failure of the attempted instance creation must be reported to it via the Status argument. If the instantiation fails (Status different
 from 1), the execution of the Process cannot proceed further and is terminated immediately.</p>
        <p>During a typical run, gPROMS may need to issue a large number of requests to the services provided by a given Foreign Object software. In order
 to minimise the overhead associated with these requests, the gFOI routine may also return to gPROMS a "handle'', ForeignObjectHandle. This is usually
 an address allowing the corresponding Foreign Object instance to be located quickly. gPROMS will <i class="emphasis">not</i> attempt any interpretation
 or make any direct use of this handle. However, it will pass it to all subsequent calls requesting services relating to this particular Foreign
 Object instance (see sections on <a href="x356.html">Foreign Object verification procedures</a>, <a href="x658.html">Foreign Object calculation procedures</a> and the <a href="x1042.html">Foreign Object termination procedure</a>).</p>
        <div>
            <p class="Footer">&#160;</p>
            <p class="Footer">&#160;</p>
            <hr width="100%" size="0" align="center" />
            <p class="Footer">Commercial in confidence</p>
            <p class="Footer">Â© 2016 Process Systems Enterprise Limited</p>
        </div>
    </body>
</html>