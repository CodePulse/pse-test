<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="Model Developer Guide.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Custom Modelling|[%=System.LinkedTitle%]|Defining Tasks">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>The Variable and Schedule sections of a Task</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/GeneralStyles.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../Model Developer Guide.htm#Topics/x6596.html">Open topic with navigation</a>
        </p>
        <div>
            <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="Custom Modelling.htm">Custom Modelling</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="Modelling in the gPROMS Language.htm">Modelling in the gPROMS Language</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="c6586.html">Defining Tasks</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">The Variable and Schedule sections of a Task</span>
            </div>
        </div>
        <h1><a name="md_task_variable"></a>The Variable and Schedule sections of a Task</h1>
        <p>The Variable section is used to declare local variables. They can only be used within the Task in which they are declared. Task Variables
 are the equivalent of local subroutine Variables and as such are calculated by the Task. They should not be confused with Model Variables and are
 NOT associated with Variable Types instead they are declared to be of type <code class="methodname">INTEGER</code> or
    <code class="methodname">REAL</code>.</p>
        <p>The Schedule section defines the operating policy implemented by the Task. It is based on the same language used to define the <a href="c5411.html">Schedule section in Process Entities</a>, the only difference being that a Task Schedule has access to the
 local variables declared in the Variable section. The values of the latter can be manipulated by using assignment statements.<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">1<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Changing the value of a Task Variable does not require a RESET statement; this only applies to Model Variables.</span></a></p>
        <div class="example" data-mc-autonum="&lt;b&gt;Example&lt;/b&gt;"><span class="autonumber"><span><b>Example</b></span></span><a name="ComplexOpsDigitalPIA"></a>
            <p><b>Example 1. Task for a digital PI control law</b>
            </p><pre class="programlisting"># TASK DigitalPI

 VARIABLE
 Error, IntegralError, ControlSignal AS REAL

 SCHEDULE
 SEQUENCE
 IntegralError := 0 ;
 WHILE TIME &lt; 1000 DO
 SEQUENCE
 CONTINUE FOR 5.0
 Error := 150.0 - Sensor101.Measurement ;
 IntegralError := IntegralError + 5.0*Error ;
 ControlSignal := 0.5 + 1.2 * ( Error + IntegralError/20.0 ) ;
 IF ControlSignal &gt; 1.0 THEN
 RESET Valve201.Position := 1.0 ; END
 ELSE
 IF ControlSignal &lt; 0.0 THEN
 RESET Valve201.Position := 0.0 ; END
 ELSE
 RESET Valve201.Position := OLD(ControlSignal) ; END
 END # If
 END # If
 END # Sequence
 END # While
 END # Sequence</pre>
        </div>
        <p>This example shows a <code class="methodname">TASK</code> that models the action of a digital PI controller. Three local variables are declared in
 the <code class="methodname">VARIABLE</code> section, namely <code class="methodname">Error</code>, <code class="methodname">IntegralError</code> and
    <code class="methodname">ControlSignal</code>. In the <code class="methodname">SCHEDULE</code> section, an assignment statement initialises
    <code class="methodname">IntegralError</code> to zero. Then, the repeated action of the controller is specified within a <code class="methodname">WHILE</code>
    structure. This is executed until a termination condition is satisfied (in this case, when 1000 time units have passed on the simulation clock).
 The action of the controller is itself a sequence of elementary Tasks. First, a <code class="methodname">CONTINUE</code> task is used to enforce a period
 of undisturbed operation (5 time units). After this, sampling takes place. The signal of a temperature sensor is used to update the controller
    <code class="methodname">Error</code> and <code class="methodname">IntegralError</code> and a <code class="methodname">ControlSignal</code> is calculated. An
    <code class="methodname">IF</code> structure is used to clip the signal which is then implemented it through a <code class="methodname">RESET</code>
    task.</p>
        <p>In essence, Tasks are user-defined tasks. Once declared, they are equivalent to elementary tasks and can be used in Process Schedules or
 even within the Schedules of other Tasks. For instance,</p><pre class="programlisting">SCHEDULE
 PARALLEL
 DigitalPI
 CONTINUE FOR 1000
 END # Parallel</pre>
        <p>executes the digital control law in parallel with the operation of the rest of the process.</p>
        <div>
            <p class="Footer">&#160;</p>
            <p class="Footer">&#160;</p>
            <hr width="100%" size="0" align="center" />
            <p class="Footer">Commercial in confidence</p>
            <p class="Footer">Â© 2017 Process Systems Enterprise Limited</p>
        </div>
    </body>
</html>