<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="Help.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Workflow guides|Process">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Flowsheets with recycles</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/GeneralStyles.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/GeneralTable.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../../Help.htm#Topics/Workflow Guides/Flowsheeting/Flowsheets with recycles.htm">Open topic with navigation</a>
        </p>
        <div>
            <div class="nocontent">
                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="5" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                </div>
            </div>
        </div>
        <h1>Flowsheets with recycles</h1>
        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Recycle streams</a></span>
            <div class="MCDropDownBody dropDownBody">
                <p>Many chemical processes involve recycles of material and energy. A recycle is a stream that flows from the outlet of a particular unit operation back to its own inlet or to the inlet of an upstream unit operation. Consider, for example, a simple process that can be modelled by a flowsheet that has a source, followed by sequence of two unit operation models, followed by a sink. For this flowsheet, a recycle stream would be a stream that flows back from the outlet of unit 2 to either the inlet of unit 1 or the inlet of unit 2. A special kind of recycle is a closed material loop. This is a recycle in which no mass is gained or lost. This type of recycle needs to be treated differently.</p>
                <div class="tip" data-mc-autonum="&lt;b&gt;Hint&lt;/b&gt;"><span class="autonumber"><span><b>Hint</b></span></span>
                    <p>For more complex processes it can be difficult to determine which streams are considered recycle streams. A practical approach is to consider all unit operations where multiple inlet streams are mixed. For each of these unit operations, consider each inlet stream in turn. Determine whether the flowrate, composition or temperature of the inlet stream depends on the outflow conditions of the unit operation that is mixing the streams. If so, that inlet stream can be considered a recycle stream.</p>
                </div>
            </div>
        </div>
        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Converging flowsheet models with recycle streams</a></span>
            <div class="MCDropDownBody dropDownBody">
                <p>Flowsheet models which involve one or more recycle streams present an extra degree of difficulty for a process simulator. The reason for this is that the solution cannot be calculated by starting at the source and then calculating the solution for each unit operation model in sequence until the inlet conditions for the sink are determined. Instead, the solution has to be determined for all unit operations simultaneously, as the performance of a downstream unit operation might have an effect on upstream unit operations. </p>
                <p>To avoid this problem, recycle streams can be "broken" during an initial solution pass of the flowsheet model. Instead of the stream condition of the recycle stream, initial guess values are supplied to the unit after the recycle breaker. The flowsheet model is then converged with these values in the initial solution pass. As soon as the initial solution pass has successfully completed, the recycle breakers are then "closed" during a second solution pass for the flowsheet, which means that they just pass their inlet conditions to their outlet. This yields the actual solution for the flowsheet model. The solution obtained in the first pass is used to aid in obtaining the solution for the second pass. <span class="ProductName">gPROMS ProcessBuilder</span> includes a 'Recycle breaker' unit model which can be used in a flowsheet model with recycle streams in order to facilitate the solution process as described above.</p>
                <div class="warning" data-mc-autonum="&lt;b&gt;Warning &lt;/b&gt;"><span class="autonumber"><span><b>Warning </b></span></span>
                    <p>If recycle streams are not treated properly, as outlined in following sections, flowsheets may still converge and produce results. However, the chance of difficult to troubleshoot simulation failures occurring is much higher. In addition, even when a flowsheet does converge, a slight change in the specifications might lead to the same flowsheet not converging at a later stage. Therefore, always make sure recycle streams are correctly identified and handled.</p>
                </div>
            </div>
        </div>
        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Recycle breakers</a></span>
            <div class="MCDropDownBody dropDownBody">
                <h3>Adding a recycle breaker to the flowsheet</h3>
                <p>To solve flowsheets involving one or more recycle streams, a Recycle breaker unit model must be included on the flowsheet for each recycle stream. Recycle breaker unit models are used to aid  the convergence of flowsheet models involving recycle streams. </p>
                <p>Each type of connection has its own associated Recycle breaker unit model in <span class="ProductName">gPROMS ProcessBuilder</span>:</p>
                <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/GeneralTable.css');" class="TableStyle-GeneralTable" cellspacing="0">
                    <col class="TableStyle-GeneralTable-Column-Column1" style="width: 372px;" />
                    <col class="TableStyle-GeneralTable-Column-Column1" />
                    <col class="TableStyle-GeneralTable-Column-Column1" />
                    <thead>
                        <tr class="TableStyle-GeneralTable-Head-Header1">
                            <th class="TableStyle-GeneralTable-HeadE-Column1-Header1">Connection type</th>
                            <th class="TableStyle-GeneralTable-HeadE-Column1-Header1">Recycle breaker unit model</th>
                            <th class="TableStyle-GeneralTable-HeadD-Column1-Header1">Library</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="TableStyle-GeneralTable-Body-Body1">
                            <td class="TableStyle-GeneralTable-BodyE-Column1-Body1">Material</td>
                            <td class="TableStyle-GeneralTable-BodyE-Column1-Body1">Recycle_breaker_gML</td>
                            <td class="TableStyle-GeneralTable-BodyD-Column1-Body1">gML Basics</td>
                        </tr>
                        <tr class="TableStyle-GeneralTable-Body-Body2">
                            <td class="TableStyle-GeneralTable-BodyE-Column1-Body2">Energy </td>
                            <td class="TableStyle-GeneralTable-BodyE-Column1-Body2">Recycle_breaker_energy_gML</td>
                            <td class="TableStyle-GeneralTable-BodyD-Column1-Body2">gML Basics</td>
                        </tr>
                        <tr class="TableStyle-GeneralTable-Body-Body1">
                            <td class="TableStyle-GeneralTable-BodyB-Column1-Body1">Signal</td>
                            <td class="TableStyle-GeneralTable-BodyB-Column1-Body1">Recycle_breaker_signal_gML</td>
                            <td class="TableStyle-GeneralTable-BodyA-Column1-Body1">gML Signal</td>
                        </tr>
                    </tbody>
                </table>
                <p>To introduce a Recycle breaker unit model for a material recycle stream, drag the 'Recycle_breaker_gML' model, from the palette, on to the flowsheet. Connect the input of the Recycle breaker unit model to the  output of the downstream unit operation. Then connect the output of the recyle breaker to the mixer that mixes the stream back to the inlet of the upstream unit operation.</p>
                <div class="example" data-mc-autonum="&lt;b&gt;Example&lt;/b&gt;"><span class="autonumber"><span><b>Example</b></span></span>
                    <p>A recycle stream needs to be added to a simple flowsheet model consisting of a Source, a Valve and a Sink unit models. </p>
                    <div class="figure">
                        <p>
                            <img src="../../../Resources/Images/Workflow guides/Constructing flowsheets/flowsheets_with_recycles_1_flowsheet_construction.png" />
                        </p>
                        <p class="FigureCaption">Flowsheet with a source, valve and a sink.</p>
                    </div>
                    <p>To add the recycle stream, first insert a mixer model before the valve and a splitter unit model after the valve. Then connect a recycle stream.&#160;Some pressure loss is assumed to occur over the recycle so a valve is added to the recycle stream. Before the recycle stream is mixed back, a recycle breaker needs to be added. </p>
                    <p>To implement the recycle, first drag a valve unit model from the palette on to the flowsheet and name it "v2". Next, drag a "Recycle_breaker_gML" unit model from the palette, in the "gML&#160;Basics" library, on to the flowsheet model and name it "rb1". Connect the recycle stream from an outlet of the splitter to the newly added valve "v2", from the valve "v2" to the recycle breaker "rb1" and finally from "rb1" to the mixer.</p>
                    <p>Configure the source model to supply a process stream of chosen material at desired conditions at a chosen mass flowrate. Configure the splitter unit such that half of the flow goes to the recycle loop and the other half to the sink. Configure the valve to have a small pressure drop (for example 1 kPa).</p>
                    <div class="figure">
                        <p>
                            <img src="../../../Resources/Images/Workflow guides/Constructing flowsheets/flowsheets_with_recycles_2_specification.png" style="width: 907px;height: 278px;" />
                        </p>
                        <p class="FigureCaption">Flowsheet after recycle stream has been added.</p>
                        <p style="text-align: left;">Open the dialog of Mixer "mix1" and on the 'Main' tab set the 'Outlet pressure specification' to 'Pressure of a particular stream'. Set the stream number to correspond to the number of the inlet that corresponds to Source "s1". To determine the inlet number of that stream, hover the mouse over the port where the stream from "s1" is connected to the Mixer.</p>
                        <div class="figure">
                            <p>
                                <img src="../../../Resources/Images/Workflow guides/Constructing flowsheets/port_hover.png" />
                            </p>
                            <p class="FigureCaption">Determine the number of the port by hovering over a particular connection and noting its index.</p>
                        </div>
                    </div>
                </div>
                <div class="warning" data-mc-autonum="&lt;b&gt;Warning &lt;/b&gt;"><span class="autonumber"><span><b>Warning </b></span></span>
                    <p>When a recycle stream is mixed back into the main process steam, make sure that for steady-state simulations the mixer is configured such that the pressure from the main process stream is propagated to the outlet. Attempting to propagate the pressure of the recycle stream or the minimum of both streams generally leads to convergence failures for the flowsheet. The reason is that the pressure of the loop might become undefined.</p>
                </div>
                <h3>Configuring a recycle breaker unit</h3>
                <p>For each Recycle breaker unit model, initial guesses for some or all of the stream variables must be supplied. These initial guesses are approximate values of the stream variables, and are typically determined based on engineering knowledge of the particular process. The required accuracy of the initial guesses can depend on the problem being solved. Some types of problems may require fairly accurate approximations of the true solution values of the recycle stream variables while for others, the flowsheet model may converge for a large range of initial guess values.</p>
                <p>To specify these initial guesses, double-click on the Recycle breaker unit model to open its unit specification dialog. The stream variables, for which initial guesses are required, depend on the connection type. </p>
                <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/GeneralTable.css');" class="TableStyle-GeneralTable" cellspacing="0">
                    <col class="TableStyle-GeneralTable-Column-Column1" style="width: 251px;" />
                    <col class="TableStyle-GeneralTable-Column-Column1" style="width: 162px;" />
                    <col class="TableStyle-GeneralTable-Column-Column1" />
                    <thead>
                        <tr class="TableStyle-GeneralTable-Head-Header1">
                            <th class="TableStyle-GeneralTable-HeadE-Column1-Header1">Recycle breaker unit model</th>
                            <th class="TableStyle-GeneralTable-HeadE-Column1-Header1">Connection type</th>
                            <th class="TableStyle-GeneralTable-HeadD-Column1-Header1">Variables for which initial guesses are required</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="TableStyle-GeneralTable-Body-Body1">
                            <td class="TableStyle-GeneralTable-BodyE-Column1-Body1">Recycle_breaker_gML</td>
                            <td class="TableStyle-GeneralTable-BodyE-Column1-Body1">Material</td>
                            <td class="TableStyle-GeneralTable-BodyD-Column1-Body1">
                                <p>Flowrate</p>
                                <p>Pressure</p>
                                <p>Composition (only required if the initial guess for flowrate is larger than 0)</p>
                                <p>Temperature or enthalpy (only required if the initial guess for flowrate is larger than 0)</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-GeneralTable-Body-Body2">
                            <td class="TableStyle-GeneralTable-BodyE-Column1-Body2">Recycle_breaker_energy_gML</td>
                            <td class="TableStyle-GeneralTable-BodyE-Column1-Body2">Energy </td>
                            <td class="TableStyle-GeneralTable-BodyD-Column1-Body2">Energy flow</td>
                        </tr>
                        <tr class="TableStyle-GeneralTable-Body-Body1">
                            <td class="TableStyle-GeneralTable-BodyB-Column1-Body1">Recycle_breaker_signal_gML</td>
                            <td class="TableStyle-GeneralTable-BodyB-Column1-Body1">Signal</td>
                            <td class="TableStyle-GeneralTable-BodyA-Column1-Body1">Signal</td>
                        </tr>
                    </tbody>
                </table>
                <div class="tip" data-mc-autonum="&lt;b&gt;Hint&lt;/b&gt;"><span class="autonumber"><span><b>Hint</b></span></span>
                    <p>In many cases an initial guess of zero flowrate will be sufficient for material recycle streams. If an initial guess of zero for the flowrate is selected, the stream composition and temperature initial guesses become irrelevant and therefore do not need to be specified. However, an initial guess for the pressure is still required.</p>
                    <p>Additionally, when the Recycle breaker with the zero flowrate initial guess is placed just before a mixer unit, the  specified initial guess for pressure may be irrelevant.  This is because a mixer unit can propagate its outlet pressure from any of its inlets. Typically, the pressure is chosen to be propagated from an inlet that is not coming from the recycle stream. In that case, the specified initial guess for pressure in the Recycle breaker  becomes irrelevant.</p>
                </div>
                <div class="example" data-mc-autonum="&lt;b&gt;Example&lt;/b&gt;"><span class="autonumber"><span><b>Example</b></span></span>
                    <p>Consider the flowsheet with the simple recycle constructed earlier. To configure the Recycle breaker "rb1",  double-click to open its dialog. In this case, leaving the default 'Operation Mode' option, using an initial guess of zero flow, is sufficient. </p>
                    <div class="figure">
                        <p>
                            <img src="../../../Resources/Images/Workflow guides/Constructing flowsheets/troubleshooting_unchecked_filed2.png" />
                        </p>
                        <p class="FigureCaption">Configuring the recycle breaker.</p>
                    </div>
                    <p>Open the dialog of Mixer "mix1" and on the 'Main' tab set the 'Outlet pressure specification' to 'Pressure of a particular stream'. Set the stream number to correspond to the number of the inlet that corresponds to Source "s1". To determine the inlet number of that stream, hover the mouse over the port where the stream from "s1" is connected to the Mixer.</p>
                    <div class="figure">
                        <p>
                            <img src="../../../Resources/Images/Workflow guides/Constructing flowsheets/port_hover.png" />
                        </p>
                        <p class="FigureCaption">Determine the number of the port by hovering over a particular connection and noting its index.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" /></a><a name="Determin"></a><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_">Determining the order in which recycle streams are solved</a></span>
            <div class="MCDropDownBody dropDownBody">
                <p>When flowsheet models involve more than one Recycle breaker unit model, the order in which the recycle streams are "closed" may affect whether the flowsheet model can be converged. <span class="ProductName">gPROMS ProcessBuilder</span> will attempt to determine an order from the flowsheet topology. In most cases this order is suitable and no further input is required. </p>
                <p>However, in some cases it may be required to specify a custom order for closing the recycle streams based on insight into the particular process being simulated. To specify the order in which to "close" recycle streams, click on the 'gPROMS&#160;language' tab at the bottom of the window in which the flowsheet model is constructed. Search for the keyword "<span style="color: #ff0000;">INITIALISATION_PROCEDURE</span>" and a subsequent block of gPROMS language code with a blue background. </p>
                <p>Below this block, the order in which Recycle breakers are closed can be specified using the gPROMS language. To do this, add a sequence of instructions of the form:</p><pre class="screen" xml:space="preserve"><span style="color: #1e90ff;">NEXT</span><br />	<span style="color: #1e90ff;" class="gPROMSLanguage">COMPLETE</span>&#160;&lt;recycle breaker unit name for recycle breaker that needs to close first&gt;;<br /><span style="color: #1e90ff;">END</span>
...

...
<span style="color: #1e90ff;" class="gPROMSLanguage">NEXT</span><br />	<span style="color: #1e90ff;" class="gPROMSLanguage">COMPLETE</span>&#160;&lt;recycle breaker unit name for recycle breaker that needs to close last&gt;;<br /><span class="gPROMSLanguage" style="color: #1e90ff;">END</span>
</pre>
                <p>The order of the recycle breaker unit names in this sequence determines which recycle breakers are closed first.</p>
                <div class="example" data-mc-autonum="&lt;b&gt;Example&lt;/b&gt;"><span class="autonumber"><span><b>Example</b></span></span>
                    <p>Given a flowsheet with two Recycle breakers, named "rb1" and "rb2", the section of code with blue background might look like:</p><pre class="screen" xml:space="preserve" style="background-color: #add8e6;"><span style="color: #ff0000;">INITIALISATION_PROCEDURE</span> default_initialisation_procedure <span style="color: #008000;">DEFAULT</span><span style="color: #696969;">
# Start Initialisation Procedure Specifications</span>
    <span style="color: #1e90ff;">USE</span>
        mix1 : Warning_only;
        rb1 : Interpolate_Close_Breaker_P_source_F_source_From_Zero;
        rb2 : Interpolate_Close_Breaker_P_source_F_source_From_Zero;
        s1 : Warning_only;
        sink1 : Warning_only;
        split1 : Warning_only;
        v001 : Warning_only;
        v1 : Warning_only;
        v2 : Warning_only;
    <span style="color: #1e90ff;">END</span><span style="color: #696969;">
# End Initialisation Procedure Specifications</span></pre>
                    <p>In order to specify that Recycle breaker "rb2" needs to close before "rb1", add the following section of code below the section of code with blue background:</p><pre class="screen" xml:space="preserve"><span style="color: #1e90ff;">NEXT</span><br />	<span style="color: #1e90ff;">COMPLETE</span>&#160;rb2;
<span style="color: #1e90ff;">END</span>
<span style="color: #1e90ff;">NEXT</span><br />	<span style="color: #1e90ff;">COMPLETE</span>&#160;rb1;<br /><span style="color: #1e90ff;">END</span></pre>
                </div>
                <div class="tip" data-mc-autonum="&lt;b&gt;Hint&lt;/b&gt;"><span class="autonumber"><span><b>Hint</b></span></span>
                    <p>The optimal order of closing Recycle breakers and applying specification trade-offs is problem dependant. However, for many cases general guidelines can be applied:</p>
                    <ul>
                        <li value="1">Close small recycles (involving few unit operations) first and larger recycles (involving many unit operations) later.</li>
                        <li value="2">If there is a recycle upstream in the process and a recycle downstream but the recycle downstream is mixed back after the recycle upstream, then close first the recycle upstream and then the recycle downstream.</li>
                        <li value="3">Some performance specifications might only be achievable when material is recycled. Either use an initial guess for the Recycle breaker, which makes the performance specification feasible when the Recycle breaker is not yet closed, or make sure to close the requisite Recycle breaker before the performance specification is applied. If the performance specification is applied on a unit operation model by specifying it in the unit operation model specification dialog (for example purity on a distillation column), consider using an Adj_spec unit model and activate this Adj_spec unit model after the recycle is closed.</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Loop breakers</a></span>
            <div class="MCDropDownBody dropDownBody">
                <p>In some cases a system can be considered to be closed in terms of material. A common example is a refrigeration loop. To solve flowsheet models that involve a closed-material loop, insert, instead of a recycle breaker, a loop breaker into the loop. The loop breaker model ("Loop_breaker_gML") can only be inserted into a loop involving gMLMaterial connection-type streams. The loop breaker model performs the same functions as a recycle breaker but additionally a material definition can be made (to determine the physical properties of the material in the loop, since there is no source model connected to this loop) and the composition of the material in the loop can be specified.</p>
            </div>
        </div>
        <div>
            <p class="Footer">&#160;</p>
            <p class="Footer">&#160;</p>
            <hr width="100%" size="0" align="center" />
            <p class="Footer">Commercial in confidence</p>
            <p class="Footer">© 2017 Process Systems Enterprise Limited</p>
        </div>
    </body>
</html>