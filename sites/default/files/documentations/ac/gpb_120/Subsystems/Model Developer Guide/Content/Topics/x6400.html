<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="Model Developer Guide.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Custom Modelling in gPROMS|Defining Schedules|Result control elementary tasks">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>The Monitor elementary task</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/GeneralStyles.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../Model Developer Guide.htm#Topics/x6400.html">Open topic with navigation</a>
        </p>
        <div>
            <div class="nocontent">
                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="5" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                </div>
            </div>
        </div>
        <h1><a name="monitorelementarytask"></a>The Monitor elementary task</h1>
        <p>Normally, during a gPROMS simulation the values of all variables at each reporting interval are sent to the Output Channel in order to be plotted. The Monitor task may be used to restrict the amount of data that is sent, and
 may be useful for a number of reasons:</p>
        <ul>
            <li value="1">
                <p>For large distributed models, which may consist of tens of thousands of variables, only a small proportion may be of particular importance
 and it may sometimes useful to prevent gPROMS from sending all of these variables. One such example is chromatographic processes, where only the
 effluent profiles may be of importance. In this case, many of the variables are of secondary importance and could be suppressed from the gPROMS
 output.</p>
            </li>
            <li value="2">
                <p>Restricting the output from gPROMS may be useful in other circumstances: for example, periodic adsorption processes require many cycles of
 operation before a periodic steady state is achieved. If the modeller is only interested in the steady-state conditions, then the output from
 gPROMS may be disabled until the final cycle.</p>
            </li>
            <li value="3">
                <p>Finally, restricting the data that are sent results in much smaller files (large distributed models may require several Megabytes of
 storage).</p>
            </li>
        </ul>
        <p>The above situations can be dealt with in two ways, depending on whether variables should be suppressed permanently or only at certain times.
 The Monitor section of the Process is used to specify which variables are to be monitored during the simulation; those that are not specified are
 permanently suppressed. If the Monitor section is omitted, then all variables are monitored. The syntax for the <code class="methodname">MONITOR</code>
      section is as follows:</p><pre class="programlisting">UNIT
 ...

 MONITOR
    <i class="emphasis">VariablePathPattern</i> ;
 ...

 SET
 ...</pre>
        <p>where <i class="emphasis">VariablePathPattern</i> is the full pathname of the variable to be monitored. Asterisks (*) and percent signs (%) can be
 used as a wild cards to specify ranges of Variables that are to be monitored. Asterisks match any <i class="emphasis">sequence</i> of characters and
 percent signs match any <i class="emphasis">single</i> character. Any Variable paths that match the string expressions in the MONITOR section are
 included in the results. Some examples of <i class="emphasis">VariablePathPattern</i> are:</p><pre class="programlisting">MONITOR
 * ; # monitor everything! (same as not including a MONITOR section

 aaa.* ; # monitor all Variables and Units in aaa

 aa% ; # monitor all Variables and Units begining with aa and ending
 # in any other character, e.g. aaa, aab, aac, aa0, aa_ etc.

 aaa.v* ; # monitor all Variables and Units in aaa that begin with a v

 aaa.*.y(*,2) ; # monitor all Variables y that belong to any Unit of aaa
 # (or any subunits thereof), provided that they are arrays of
 # dimension &gt; 1; monitor only the elements with the last index = 2
 *.x* ; # all variables starting with x would be monitored in all units
 # also, any units starting with x would also be monitored entirely</pre>
        <p>Note that for distributed variables (i.e. those that depend on a DISTRIBUTION_DOMAIN), the indices must be integers and depend on the numerical
 method applied to the domain. For each distributed variable, gPROMS will generate an indexed variable with the same number of dimensions as the
 number of DISTRIBUTION_DOMAINs that the variable depends on. The length of each dimension is equal to <i class="emphasis">NE × O + 1</i> for
      <code class="methodname">OCFEM</code> and <i class="emphasis">NE+1</i> for finite difference methods, where <i class="emphasis">NE</i> is the number of elements
 and <i class="emphasis">O</i> is the order of the method. For example, if the variable <code class="methodname">DV1</code> is defined by:</p><pre class="programlisting">DV1 AS DISTRIBUTION(x,y) OF NoType</pre>
        <p>where the <code class="methodname">DISTRIBUTION_DOMAIN</code>s <i class="emphasis">x</i> and <i class="emphasis">y</i> are Set to the following
 methods:</p><pre class="programlisting">x := [ OCFEM, 3, 5 ] ;
 y := [ BFDM, 2, 20 ] ;</pre>
        <p>then the maximum values for the indices of <code class="methodname">DV1</code> are 16 (<i class="emphasis">5 × 3 + 1</i>) and 21
 (<i class="emphasis">20+1</i>) respectively.</p>
        <p>During the simulation, the output of all variables that are specified in the Monitor section can be toggled using the Monitor task. The syntax
 for this is:</p><pre class="programlisting">MONITOR ON</pre>
        <p>to enable monitoring, and:</p><pre class="programlisting">MONITOR OFF</pre>
        <p>to disable monitoring. Note that this is a Task that can only appear in the Schedule of a Process and is distinct from the
      <code class="methodname">MONITOR</code> section of the Process.</p>
        <p>One final use of the <code class="methodname">MONITOR</code> Task is to change the frequency at which results are sent to the Output Channel(s). This
 is done by:</p><pre class="programlisting">MONITOR FREQUENCY <i class="emphasis">NumericalValue</i></pre>where
      <i class="emphasis"><code class="varname">NumericalValue</code></i> is a number or an expression that results in a number.<p>An example of the <code class="methodname">MONITOR</code> task is shown in the gPROMS code below, where the task <code class="methodname">DoSomeCycles</code>
      operates the process until cyclic steady stage is achieved, then <code class="methodname">DoOneCycle</code> operates the process for a single cycle after
 monitoring has been enabled.</p><div class="example" data-mc-autonum="&lt;b&gt;Example&lt;/b&gt;"><span class="autonumber"><span><b>Example</b></span></span><a name="AEN6455"></a><p><b>Example 10. Example of the MONITOR task</b></p><pre class="programlisting">SCHEDULE
 SEQUENCE
 MONITOR OFF
 DoSomeCycles ;
 MONITOR ON
 DoOneCycle ;
 END</pre></div><p>Another example of the <code class="methodname">MONITOR</code> task, illustrating the <code class="methodname">FREQUENCY</code> keyword, is shown next. In
 this example, the first Task manipulates the inputs of the system slowly so that a reporting interval of 10 is more than enough to observe the
 dynamics. Then, the <code class="varname">FastOperation</code> Task creates much faster dynamics, which are too fast to be seen clearly with a reporting
 interval of 10. The <code class="methodname">MONITOR</code> task changes the reporting interval to a more suitable value. The benefit of this approach,
 compared with simply setting the <code class="methodname">ReportingInterval</code> to 1 in the <code class="methodname">SOLUTIONPARAMETERS</code> section, is that
 the resulting Case is much smaller.</p><pre class="programlisting">SOLUTIONPARAMETERS
 ReportingInterval := 10 ;

 SCHEDULE
 SEQUENCE
 SlowOperation ;
 MONITOR FREQUENCY 1
 FastOperation ;
 END</pre><p>where SlowOperation and FastOperation are Tasks that respectively produce slow and fast dynamics in the simulation.</p><p>Exactly when the reporting interval is updated depends on when the MONITOR Task is encountered. gPROMS will always continue to the end of the
 current reporting interval before updating. The example below illustrates precisely what happens.</p><pre class="programlisting">SOLUTIONPARAMETERS
 ReportingInterval := 10;

 SCHEDULE
 SEQUENCE
 CONTINUE FOR 7
 MONITOR FREQUENCY 1
 CONTINUE FOR 8
 END</pre><div class="figure"><a name="AEN6469"></a><div class="mediaobject"><p><img src="../Resources/Images/MDG_MonitorFrequencyExample.png" /></p></div><p class="FigureCaption"> Output from the example Schedule illustrating MONITOR FREQUENCY</p></div><p>As can be seen, gPROMS starts at time, t = 0 and begins integration with the reporting interval equal to 10, so gPROMS outputs data at t = 0
 and the next set of data are due at t = 10. At t = 7.76, the Continue Task ends, so a set of data is sent to the output channel at this time (because
 data are always sent when a discontinuity occurs). The reporting interval is updated to every 1 unit of time but this will not change until the next
 scheduled reporting time, t = 10, so gPROMS then integrates from 7.76 to 10. At t = 10 another set of data is sent to the output channel and the new
 reporting interval takes effect: gPROMS now integrates from 10 to 11, and so on.</p><p>The reason for this behaviour is clear: if gPROMS were to update the reporting interval immediately, then data would be sent to the output
 channel at times 0, 7.76, 8.76, 9.76 etc., which is not very elegant.</p><div><p class="Footer">&#160;</p><p class="Footer">&#160;</p><hr width="100%" size="0" align="center" /><p class="Footer">Commercial in confidence</p><p class="Footer">© 2017 Process Systems Enterprise Limited</p></div></body>
</html>