<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="System Programmer Guide.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="System Programmer Guide|Developing New Foreign Objects|Implementation of Foreign Objects">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Writing Foreign Objects</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/GeneralStyles.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../System Programmer Guide.htm#Topics/x1087.html">Open topic with navigation</a>
        </p>
        <div>
            <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="c251.html">System Programmer Guide</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="c271.html">Developing New Foreign Objects</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="x1084.html">Implementation of Foreign Objects</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Writing Foreign Objects</span>
            </div>
        </div>
        <h1><a name="WritingForeignObjects"></a>Writing Foreign Objects</h1>
        <p>In principle, Foreign Object software can be written in any procedural language such as FORTRAN, C and C++ . Although the first two are
 perfectly adequate, at least for simple applications, special care must be taken if the problem under consideration makes use of multiple instances
 of the same Foreign Object class. In such cases, it is important that each instance has a separate area of private storage. This is not a trivial
 task if the private storage is allocated statically (as is the case with FORTRAN) because essentially there is just a <i class="emphasis">single</i>
      area of storage that is declared by the code describing the Foreign Object class.</p>
        <p>There are several ways of overcoming the above difficulty with different degrees of elegance, efficiency and ease of implementation:</p>
        <ol type="1">
            <li value="1">
                <p><i class="emphasis">Create multiple copies of the same class</i>.</p>
                <p>This is rather inefficient since it involves keeping multiple copies of the same code under different names. Realistically, it is an option
 only with very small Foreign Object codes.</p>
            </li>
            <li value="2">
                <p><i class="emphasis">Allocate large static workspace in Foreign Object class code and manage its allocation and use among all instances of the
 class</i>.</p>
                <p>Perhaps the easiest way of achieving this is by using the ForeignObjectHandle (see section on <a href="x301.html">Foreign Object initialisation procedure</a>) as a means of indexing the instances of the class
 that are active at any given time. In particular, the gFOI procedure can maintain a count of the number of instances that have been created thus
 far; initially this is zero. Each invocation of gFOI increases this count by 1 and returns its current value as the ForeignObjectHandle.</p>
                <p>Consider, now, a Foreign Object class, each instance of which requires a real workspace of length 1000 . Suppose, furthermore, that it is
 expected that any gPROMS problem might involve up to 10 such instances. In a FORTRAN implementation, we can then declare a workspace array in a
 COMMON block of the form:</p><pre class="programlisting">COMMON /WWW/ W(10,1000)</pre>
                <p>and insert this in all 6 service procedures (see section on <a href="x276.html">the gPROMS Foreign Object
 Interface</a>). Then each of the latter can use the value of the ForeignObjectHandle passed to it by gPROMS to reference the correct part of
 the workspace.</p>
            </li>
            <li value="3">
                <p><i class="emphasis">Allocate workspace for each Foreign Object instance dynamically</i>.</p>
                <p>This option differs from 2 above in that there is no need to allocate a static array that is large enough to hold the data for all
 instances that might be created during a run. Instead, each call to gFOI allocates the required workspace dynamically. The ForeignObjectHandle
 returned by gFOI could be a pointer to the workspace allocated for the corresponding instance.</p>
                <p>Obviously, this option is available only with languages that allow such dynamic storage operation (e.g. C).</p>
            </li>
        </ol>
        <p>Of course, truly object-oriented languages such as C++ do provide a real advantage in making it easier to handle multiple instances of a
 Foreign Object class being used in the same problem. By defining a C++ class whose methods are those of the Foreign Object and whose private data
 include everything which is specific to a given instance, the gFOI routine can consist simply of creating an instance of this C++ class. The private
 data of this instance can be established e.g. in the constructor of this class or in special initialization methods.</p>
        <div class="warning" data-mc-autonum="&lt;b&gt;Warning &lt;/b&gt;"><span class="autonumber"><span><b>Warning </b></span></span>
            <p>In writing code for Foreign Objects, always use the default declaration for INTEGER type arguments to the six service procedures.</p>
            <p>Do <i class="emphasis">not</i> make use of any explicit declarations of integer variable lengths (e.g. INTEGER*4). Doing so may render your code
 incompatible with gPROMS on some platforms (e.g. those using 64-bit integers).</p>
        </div>
        <div>
            <p class="Footer">&#160;</p>
            <p class="Footer">&#160;</p>
            <hr width="100%" size="0" align="center" />
            <p class="Footer">Commercial in confidence</p>
            <p class="Footer">Â© 2016 Process Systems Enterprise Limited</p>
        </div>
    </body>
</html>