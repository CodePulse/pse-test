<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="Model Developer Guide.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Custom Modelling in gPROMS|Controlling the Execution of Model-based Activities|Standard solvers for differential-algebraic equations">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>The SRADAU solver</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/GeneralStyles.css" rel="stylesheet" />
        <link href="../Resources/TableStyles/GeneralTable.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../Model Developer Guide.htm#Topics/x8253.html">Open topic with navigation</a>
        </p>
        <div>
            <div class="nocontent">
                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="5" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                </div>
            </div>
        </div>
        <h1><a name="AEN8253"></a>The SRADAU solver</h1>
        <p>The algorithmic parameters used by SRADAU along with their default values are shown below. This is followed by a detailed description of each
 parameter.</p><pre class="programlisting">"SRADAU" ["InitialisationNLSolver" := "BDNLSOL";
 "LASolver" := "MA48";
 "ReinitialisationNLSolver" := "BDNLSOL";
 "AbsoluteTolerance" := 1E-5;
 "Diag" := FALSE;
 "MaxStepSize" := 1.0E10;
 "EventTolerance" := 1E-5;
 "OutputLevel" := 0;
 "RelativeTolerance" := 1E-5;
 "VariablesWithLargestCorrectorSteps" := 0]</pre>
        <ul>
            <li value="1">
                <p>InitialisationNLSolver: A quoted string specifying a nonlinear algebraic equation solver.</p>
                <p>The solver to be used for the solution of nonlinear algebraic equations occurring at the initialisation stage of the integration. This can
 be either one of the standard gPROMS nonlinear algebraic equation solver or a third-party nonlinear algebraic equation solver (see the gPROMS
 System Programmer Guide). The default is BDNLSOL. This parameter can be followed by further specifications aimed at configuring the particular
 solver by setting values to its own algorithmic parameters.</p>
            </li>
            <li value="2">
                <p>LASolver: A quoted string specifying a linear algebraic equation solver.</p>
                <p>The solver to be used for the solution of linear algebraic equations at each step of the integration. This can be either one of the
 standard gPROMS linear algebraic equation solvers or a third-party linear algebraic equation solver (see the gPROMS System Programmer Guide). The
 default is MA48. This parameter can be followed by further specifications aimed at configuring the particular solver by setting values to its own
 algorithmic parameters.</p>
            </li>
            <li value="3">
                <p>ReinitialisationNLSolver: A quoted string specifying a nonlinear algebraic equation solver.</p>
                <p>The solver to be used for the solution of nonlinear algebraic equations that is necessary for re-initialisation following discontinuities.
 This can be either one of the standard gPROMS nonlinear algebraic equation solvers or a third-party nonlinear algebraic equation solver (see the
 gPROMS System Programmer Guide). The default is SPARSE. This parameter can be followed by further specifications aimed at configuring the
 particular solver by setting values to its own algorithmic parameters.</p>
            </li>
            <li value="4">
                <p>AbsoluteTolerance: A real number in the range [10<sup>-20</sup>, 10<sup>10</sup>].</p>
                <p>The absolute integration tolerance. Together with the parameter RelativeTolerance (see below), they determine whether or not a time step
 taken by the solver is sufficiently accurate.</p>
            </li>
            <li value="5">
                <p>Diag: A boolean value.</p>
                <p>Specifies whether very detailed diagnostic information is to be generated during integration.</p>
            </li>
            <li value="6">
                <p>EventTolerance: A real number in the range [10<sup>-20</sup>, 10<sup>10</sup>].</p>
                <p>The event tolerance, i.e. the maximum time interval within which discontinuities during integration are located.</p>
            </li>
            <li value="7">
                <p>MaxStepSize: A real number in the range [10<sup>-20</sup>, 10<sup>100</sup>]; default =
 10<sup>10</sup>.</p>
                <p>This Solution Parameter sets the maximum step size used by the integrator when advancing in time.</p>
            </li>
            <li value="8">
                <p>OutputLevel: An integer in the range [0, 4].</p>
                <p>The amount of information generated by the solver. The following table indicates the lowest level at which different types of information
 are produced:</p>
                <div class="informaltable"><a name="AEN8289"></a>
                    <table style="mc-table-style: url('../Resources/TableStyles/GeneralTable.css');margin-left: auto;margin-right: auto;" class="TableStyle-GeneralTable" cellspacing="0">
                        <tbody>
                            <tr class="TableStyle-GeneralTable-Body-Body1">
                                <td class="TableStyle-GeneralTable-BodyE-Column1-Body1">0</td>
                                <td class="TableStyle-GeneralTable-BodyD-Column1-Body1">(None)</td>
                            </tr>
                            <tr class="TableStyle-GeneralTable-Body-Body2">
                                <td class="TableStyle-GeneralTable-BodyE-Column1-Body2">1</td>
                                <td class="TableStyle-GeneralTable-BodyD-Column1-Body2">(Re-)initialisation times, projection of predictor onto bounds, variables hitting bounds</td>
                            </tr>
                            <tr class="TableStyle-GeneralTable-Body-Body1">
                                <td class="TableStyle-GeneralTable-BodyE-Column1-Body1">2</td>
                                <td class="TableStyle-GeneralTable-BodyD-Column1-Body1">Successful initialisation, change of branch in IF conditional equations, location of discontinuities, step failures, repeated
 convergence failures, predictor outside bounds, predictor step reduction, variables stuck on bounds</td>
                            </tr>
                            <tr class="TableStyle-GeneralTable-Body-Body2">
                                <td class="TableStyle-GeneralTable-BodyE-Column1-Body2">3</td>
                                <td class="TableStyle-GeneralTable-BodyD-Column1-Body2">Detail of convergence failures,values of derivatives on commencing integration, number of perturbation groups, step length
 reduction due to bounds violation</td>
                            </tr>
                            <tr class="TableStyle-GeneralTable-Body-Body1">
                                <td class="TableStyle-GeneralTable-BodyB-Column1-Body1">4</td>
                                <td class="TableStyle-GeneralTable-BodyA-Column1-Body1">Variable causing discontinuity, detail of perturbation groups</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </li>
            <li value="9">
                <p>RelativeTolerance: A real number in the range [10<sup>-20</sup>, 10<sup>10</sup>].</p>
                <p>The relative integration tolerance. Together with the parameter AbsoluteTolerance (see above), they determine whether or not a time step
 taken by the solver is sufficiently accurate.</p>
            </li>
            <li value="10">
                <p>VariablesWithLargestCorrectorSteps: An integer between 0 and 1000; default = 0.</p>
                <p>On rare occasions, SRADAU fails with a "corrector step failure" message. This indicates that the code is unable to establish a set of
 variable values that satisfy the system equations at a particular point. It is often caused by errors or bad scaling in some modelling equations
 which results in the corrector iterations taking excessively large steps in some of the variables. To help with the diagnosis of such problems,
 SRADAU can report the variables with the largest relative change at each corrector iteration. The relative change for a variable
          <i class="emphasis">X</i> is defined as:</p>
                <p><span class="inlinemediaobject"><img src="../Resources/Images/eqn_cteomba_42.png" data-mc-conditions="Default.ScreenOnly" /></span>
                </p>
                <p>where:</p>
                <ul>
                    <li value="1">
                        <p><span class="inlinemediaobject"><img src="../Resources/Images/eqn_cteomba_43.png" data-mc-conditions="Default.ScreenOnly" /></span> is the step in the variable at this corrector iteration;</p>
                    </li>
                    <li value="2">
                        <p><i class="emphasis">a</i> is the absolute tolerance;</p>
                    </li>
                    <li value="3">
                        <p><i class="emphasis">r</i> is the relative tolerance.</p>
                    </li>
                </ul>
                <p>The parameter VariablesWithLargestCorrectorSteps specifies the number of variables to be reported in this manner. Note that such reporting
 takes place only if the parameter OutputLevel is set to a value of 0 or higher.</p>
                <p>An example of the output is shown below:</p><pre class="programlisting">Variables with largest (weighted) corrector steps follow...

Differential and algebraic variables (norm = 227.542):

----------------------------------------------------------------------------------------------------------------------------------
| Variable | Name | Current Value | Corrector Step | Weighted Corrector Step | Contribution to Norm |
----------------------------------------------------------------------------------------------------------------------------------
| 1 | Plant.Reactor.STR.rho_L | 12126 | 548.071 | 4519.44 | 50.00% |
| 2 | Plant.Reactor.STR.c(5) | 12126 | 548.071 | 4519.44 | 50.00% |
| 3 | Plant.Reactor.STR.vol_L | 0.000824675 | -3.72737E-05 | -3.7243 | 0.00% |
| 4 | Plant.Reactor.STR.q_Loss | 0.00692394 | -6.05969E-06 | -0.601802 | 0.00% |
| 5 | Plant.Reactor.STR.ThermoHL.hli(2) | -5.12137E-10 | -1.41695E-06 | -0.141695 | 0.00% |
----------------------------------------------------------------------------------------------------------------------------------

Algebraic variables only (norm = 250.308):

----------------------------------------------------------------------------------------------------------------------------------
| Variable | Name | Current Value | Corrector Step | Weighted Corrector Step | Contribution to Norm |
----------------------------------------------------------------------------------------------------------------------------------
| 1 | Plant.Reactor.STR.rho_L | 12126 | 548.071 | 4519.44 | 50.00% |
| 2 | Plant.Reactor.STR.c(5) | 12126 | 548.071 | 4519.44 | 50.00% |
| 3 | Plant.Reactor.STR.vol_L | 0.000824675 | -3.72737E-05 | -3.7243 | 0.00% |
| 4 | Plant.Reactor.STR.q_Loss | 0.00692394 | -6.05969E-06 | -0.601802 | 0.00% |
| 5 | Plant.Reactor.STR.ThermoHL.hli(2) | -5.12137E-10 | -1.41695E-06 | -0.141695 | 0.00% |
----------------------------------------------------------------------------------------------------------------------------------</pre>
                <p>The output is grouped in terms of differential and algebraic Variables and only algebraic Variables. In each case, a norm value is also
 reported. For differential and algebraic variables, this is defined by:</p>
                <p><span class="inlinemediaobject"><img src="../Resources/Images/eqn_norm_diff_alg2.png" data-mc-conditions="Default.ScreenOnly" /></span>
                </p>
                <p>where <i class="emphasis">N</i> is the number of equations. Subsequent lines list the largest
          <code class="varname">VariablesWithLargestCorrectorSteps</code> Variables and their relative changes.</p>
                <p>For algebraic Variables only, then norm is similarly defined:</p>
                <p><span class="inlinemediaobject"><img src="../Resources/Images/eqn_norm_alg2.png" data-mc-conditions="Default.ScreenOnly" /></span>
                </p>
                <p>where <i class="emphasis">N<sub>alg</sub></i> is the number of algebraic Variables and the summation is over only the algebraic
 Variables. Again, a list of the algebraic variables with the largest corrector steps then follows.</p>
            </li>
        </ul>
        <div>
            <p class="Footer">&#160;</p>
            <p class="Footer">&#160;</p>
            <hr width="100%" size="0" align="center" />
            <p class="Footer">Commercial in confidence</p>
            <p class="Footer">© 2017 Process Systems Enterprise Limited</p>
        </div>
    </body>
</html>