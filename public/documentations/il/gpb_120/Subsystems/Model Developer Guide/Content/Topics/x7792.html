<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-gb" xml:lang="en-gb" data-mc-search-type="Stem" data-mc-help-system-file-name="Model Developer Guide.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Custom Modelling in gPROMS|Controlling the Execution of Model-based Activities">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Standard solvers for differential-algebraic equations</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/GeneralStyles.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../Model Developer Guide.htm#Topics/x7792.html">Open topic with navigation</a>
        </p>
        <div>
            <div class="nocontent">
                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="5" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                </div>
            </div>
        </div>
        <h1><a name="daesolvers"></a>Standard solvers for differential-algebraic equations</h1>
        <p>There are two standard mathematical solvers for the solution of mixed sets of differential and algebraic equations in gPROMS, namely DASOLV and
 SRADAU:</p>
        <ul>
            <li value="1">
                <p>DASOLV is based on variable time step/variable order Backward Differentiation Formulae (BDF). This has been proved to be efficient for a wide
 range of problems. However, BDF solvers suffer from loss of stability for certain types of problems (e.g. highly oscillatory ones) and they are not
 very efficient for problems with frequent discontinuities.</p>
            </li>
            <li value="2">
                <p>SRADAU implements a variable time step, fully-implicit Runge-Kutta method. It has been proved to be efficient for the solution of problems
 arising from the discretisation of PDAEs with strongly advective terms (in general, highly oscillatory ODEs), and models with frequent
 discontinuities.</p>
            </li>
        </ul>
        <p>Both of the above solvers are designed to deal with large, sparse systems of equations in which the variable values are restricted to lie within
 specified lower and upper bounds. Moreover, they can handle situations in which some of the partial derivatives of the equations with respect to the
 variables are available analytically while the rest have to approximated<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">1<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>In gPROMS models, almost all partial derivatives are computed analytically from expressions derived using symbolic manipulations. The main
 exception is partial derivatives of equations involving any Foreign Object methods that are not capable of returning partial derivatives.</span></a>. Efficient finite difference approximations are used for the latter purpose. Both solvers automatically adjust each time step taken so
 that the following criterion is satisfied:</p>
        <p><span class="inlinemediaobject"><img src="../Resources/Images/eqn_cteomba_33.png" data-mc-conditions="Default.ScreenOnly" /></span>
        </p>
        <p>where:</p>
        <ul>
            <li value="1">
                <p><i class="emphasis">n<sub>d</sub></i> is the number of differential variables in the problem (i.e. those that appear as
        <code class="methodname">$x</code> in the gPROMS model);</p>
            </li>
            <li value="2">
                <p><span class="inlinemediaobject"><img src="../Resources/Images/eqn_cteomba_34.png" data-mc-conditions="Default.ScreenOnly" /></span> is the solver's estimate for the local error in the<i class="emphasis"> i<sup>th</sup></i> differential
 variable;</p>
            </li>
            <li value="3">
                <p><i class="emphasis">x<sub>i</sub></i> is the current value the <i class="emphasis">i<sup>th</sup></i> differential
 variable;</p>
            </li>
            <li value="4">
                <p><i class="emphasis">a</i> is an absolute error tolerance;</p>
            </li>
            <li value="5">
                <p><i class="emphasis">r</i> is a relative error tolerance.</p>
            </li>
        </ul>
        <p>In rough terms, this means that the error <span class="inlinemediaobject"><img src="../Resources/Images/eqn_cteomba_35.png" data-mc-conditions="Default.ScreenOnly" /></span> incurred in a particular variable <i class="emphasis">x<sub>i</sub></i> over a single time step is not allowed to exceed
    <span class="inlinemediaobject"><img src="../Resources/Images/eqn_cteomba_36.png" data-mc-conditions="Default.ScreenOnly" /></span>. The default values for <i class="emphasis">a</i> and <i class="emphasis">r</i> (10<sup>-5</sup> in both cases) are
 usually adequate since:</p>
        <ul>
            <li value="1">
                <p>they control the error in variables <i class="emphasis">x<sub>i</sub></i> of size 0.01 or higher to within acceptable ranges;</p>
            </li>
            <li value="2">
                <p>smaller variable values are often not important from an engineering point of view<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">2<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>For example, a liquid level in a processing vessel of 10-4m is practically indistinguishable from one of
 10-5m.</span></a>.</p>
            </li>
        </ul>
        <p>However, for problems in which small variable values may have an important effect on system behaviour, it is advisable to specify a smaller
 absolute tolerance<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">3<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>For example, in a problem involving free radicals or ions, it may be important to distinguish between mole fraction of
 10-6 and 10-7.</span></a>.</p>
        <p>At the end of each simulation, if an estimate of the error committed in any variable at any time step exceeds a threshold, this is reported. See
 the <a href="x8228.html">Large residual warnings</a> section for details.</p>
        <p>The DASolver solution parameter may be used to change and/or configure the solver used for simulation activities, as well as the default DAE
 sub-solver used by all higher-level solvers. If this parameter is not specified, then the DASOLV solver is used, with the default configuration shown
 at the start of the section below.</p>
        <div>
            <p class="Footer">&#160;</p>
            <p class="Footer">&#160;</p>
            <hr width="100%" size="0" align="center" />
            <p class="Footer">Commercial in confidence</p>
            <p class="Footer">Â© 2017 Process Systems Enterprise Limited</p>
        </div>
    </body>
</html>